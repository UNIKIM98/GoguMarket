<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.goguma.auct.mapper.AuctMapper">


	<select id="getAuctList"
		parameterType="com.goguma.auct.vo.AuctVO"
		resultType="com.goguma.auct.vo.AuctVO">
		SELECT a.* ,
		       (SELECT ATCH_PATH
	       		FROM ATCH
	       		WHERE ATCH_ID = a.ATCH_ID AND ROWNUM=1) ATCH_NM
		FROM AUCT a
		ORDER BY AUCT_NO DESC
	</select>

	<select id="getAuct"
		parameterType="com.goguma.auct.vo.AuctVO"
		resultType="com.goguma.auct.vo.AuctVO">
		SELECT * FROM AUCT
		WHERE AUCT_NO = #{auctNo}
	</select>

	<insert id="insertAuct"
			parameterType="com.goguma.auct.vo.AuctVO">
		

	      <selectKey keyProperty="auctNo" resultType="int"
	         order="BEFORE">
	         SELECT NVL(MAX(AUCT_NO),0)+1 AS AUCTNO
	         FROM AUCT
	      </selectKey>
		INSERT INTO AUCT (
		AUCT_NO, REG_YMD, DDLN_YMD, AUCT_TTL, CTGRY,
		AUCT_CN, LOW_PRC, QUICK_PRC, ATCH_ID, USER_ID
		) VALUES 		(
		#{auctNo}, SYSDATE,	#{ddlnYmd},	#{auctTtl}, #{ctgry},
		#{auctCn}, #{lowPrc}, #{quickPrc}, #{atchId}, #{userId}
		)
	</insert>
<!-- 
	<update id="noticeUpdate"
		parameterType="co.king.prj.notice.service.NoticeVO">
		UPDATE AUCT
		<set>
			<if test="auctTtl != null">AUCT_TTL = #{auctTtl},</if>
			<if test="ctgry != null">ctgry = #{ctgry},</if>
			<if test="auctCn != null">AUCT_CN = #{auctCn},</if>
			<if test="quickPrc != null">QUICK_PRC = #{quickPrc},</if>
			<if test="stts != null">stts = #{stts},</if>
			<if test="atchId != null">ATCH_ID = #{atchId},</if>
			<if test="noticeSubject != null">NOTICE_SUBJECT = #{noticeSubject}</if>
		</set>
		WHERE AUCT_NO = #{auctNo}
	</update>

	<delete id="deleteAuct"
		parameterType="com.goguma.auct.vo.AuctVO">
		DELETE FROM AUCT WHERE AUCT_NO = #{auctNo}
	</delete>
	
	
	<update id="auctHitUpdate">
		UPDATE AUCT
		SET INQ_CNT = INQ_CNT + 1
		WHERE AUCT_NO = #{auctNo}
	</update>
	
 -->
</mapper>