<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://ultraq.net/thymeleaf/layout"
    layout:decorate="~{/layouts/layout}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style>
@font-face {
	font-family: 'S-CoreDream-3Light';
	src:
		url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/S-CoreDream-3Light.woff')
		format('woff');
	font-weight: normal;
	font-style: normal;
}

* {
	font-family: 'S-CoreDream-3Light';
}

#uploadFileList {
	width: 100%;
	height: 20%;
	padding: 10px;
	/* 		border: 1px solid lightgrey; */
	/* 		border-radius: 5px; */
	margin-bottom: 30px;
}

#uploadFileList:empty:before {
	content: attr(data-placeholder);
	color: #999;
	font-size: .9em;
}

.message-box input[type=text], textarea {
	width: 70%;
}

.message-box label {
	width: 25%;
}

#aFrm span{
	color : red;
}
</style>
<script src="https://code.jquery.com/jquery-3.6.3.js"
		integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
		crossorigin="anonymous"></script>
</head>
<body>
<div layout:fragment="content">
		<!-- Body main wrapper start -->
		<div class="wrapper" >
		<div class="breadcrumbs-section plr-200 mb-80 section">
                <div class="breadcrumbs overlay-bg">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="breadcrumbs-inner">
                                    <h1 class="breadcrumbs-title">ê²½ë§¤í’ˆ ë“±ë¡í•˜ê¸°</h1>
                                    <ul class="breadcrumb-list">
                                        <li><a href="index.html">Home</a></li>
                                        <li><a href="#">Auction Insert Form</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
			<!-- Start page content -->
			<section id="page-content" class="page-wrapper section">

				<!-- MESSAGE BOX SECTION START -->
				<div class="message-box-section mb-80">
					<div class="container">
						<div class="row">
							<div class="col-lg-12" style="width: 70%">
								<div class="message-box box-shadow white-bg">
									<!-- â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  ì£¼ì˜1 â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  -->
									<form id="aFrm" method="post" enctype="multipart/form-data" onsubmit="return false">
										<!-- â– â– â†‘ form id ìƒˆë¡œ ì§€ì •í•´ì£¼ì„¸ìš” â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  -->
										<div class="row">
											<div class="col-lg-12">
												<h4 class="blog-section-title border-left mb-30">get in auction</h4>
											</div>
										</div>
										<!-- â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  ì£¼ì˜2 â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  -->
										<div class="col-lg-10" id="inputFile">
											<label for="files">ìƒí’ˆì‚¬ì§„<span> *</span></label> 
											<input type="file" id="files" placeholder="ì²¨ë¶€íŒŒì¼" multiple="multiple">
											<br>
											<span id="fileErrMsg"></span>
											<div id="fileList">
												<div id="uploadFileList" data-placeholder='ğŸ¶ì²¨ë¶€íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤ğŸŒ³' 
													 class="message-box box-shadow white-bg"></div>
											</div>
										</div>
										<!-- â– â– â– â†‘ ê±´ë“œë¦¬ë©´ ì£½ìŒë¿.â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  -->
										 <div class="col-lg-10">
                                            <label for="ctgry">ì¹´í…Œê³ ë¦¬<span> *</span></label>
                                            <input type="radio" name="ctgry" id="ctgry" value="HA" class="ctgry">ìƒí™œê°€ì „
                                            <input type="radio" name="ctgry" id="ctgry" value="HO" class="ctgry">ì·¨ë¯¸/ê²Œì„/ìŒë°˜
                                            <input type="radio" name="ctgry" id="ctgry" value="FU" class="ctgry">ê°€êµ¬/ì¸í…Œë¦¬ì–´
                                            <input type="radio" name="ctgry" id="ctgry" value="FO" class="ctgry">ê°€ê³µì‹í’ˆ
                                            <input type="radio" name="ctgry" id="ctgry" value="ETC" class="ctgry">ê¸°íƒ€
                                        	<span id="ctgryErrMsg"></span>
                                        </div>
										<div class="col-lg-10 ">
											<label for="auctTtl">ê¸€ì œëª©<span> *</span></label>
											<input type="text" name="auctTtl" id="auctTtl" placeholder="ê¸€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”.">
										</div>
										<div class="col-lg-10">
											<label for="auctCn">ìƒí’ˆì„¤ëª…<span> *</span></label>
											<textarea class="custom-textarea" name="auctCn" id="auctCn" 
													  placeholder="ê²Œì‹œê¸€ ë‚´ìš©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë‹¨, íŒë§¤ê¸ˆì§€ ë¬¼í’ˆì€ ê²Œì‹œê°€ ì œí•œë  ìˆ˜ ìˆì–´ìš” :)"></textarea>
										</div>
										<div class="col-lg-10">
											<label for="lowPrc">ê²½ë§¤ì‹œì‘ê°€<span> *</span></label>
                                            <input type="text" name="lowPrc" id="lowPrc" placeholder="ê²½ë§¤ì‹œì‘ê°€">
                                        </div>
                                        <div class="col-lg-10">
                                        	<label for="quickPrc">ì¦‰ì‹œêµ¬ë§¤ê°€(ì„ íƒ)</label>     
                                            <input type="text" name="quickPrc" id="quickPrc" placeholder="ì¦‰ì‹œêµ¬ë§¤ê°€">
                                        </div>
                                        <div class="col-lg-10">
                                        	<label for="ddlnYmd">ê²½ë§¤ì¢…ë£Œì¼<span> *</span></label>     
                                            <input type="date" name="ddlnYmd" id="ddlnYmd">
                                        </div>
                                        <button class="submit-btn-1 mt-30 btn-hover-1" type="reset">ì·¨ì†Œ</button>
										<button class="submit-btn-1 mt-30 btn-hover-1"
                                                onclick="goList()" >ëª©ë¡</button>
										<input class="submit-btn-1 mt-30 btn-hover-1" type="submit" id="btnSave" role="button" value="ë“±ë¡í•˜ê¸°">
									</form>
								</div>
								<!-- </form> -->
							</div>
						</div>
					</div>
				</div>
			</section>
		</div>
	
	<script th:inline="javascript">
		//==============================================================================
		//âœ… DOM ê·¸ë¦¬ë©´ì„œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ (== document.onload())
			$(function() {
				$("#files").on("change", function(e) {
					$("#fileErrMsg").text("")
					inputFile(e);
				});
				console.log(typeof($(".ctgry")))
				
				$(".ctgry").on("change", function(){
						$("#ctgryErrMsg").text("")
					})
				
				$("#btnSave").on("click", function() {
					submitForm();
				});
			});
		
		//==============================================================================
		//ğŸ“Œ	 ê³µí†µìœ¼ë¡œ ì“°ì¼ ë³€ìˆ˜ ì„ ì–¸(ì „ì—­ë³€ìˆ˜ var)
			var fileCount = 0; //í˜„ì¬ ì²¨ë¶€íŒŒì¼ ê°œìˆ˜
			var totalCount = 10; // ì²¨ë¶€ ê°€ëŠ¥í•œ íŒŒì¼ ê°œìˆ˜
			var fileNum = 0; //ì²¨ë¶€íŒŒì¼ ì¸ë±ìŠ¤
			var inputFileList = new Array(); // insert íŒŒì¼ ë°°ì—´
			var deleteFileList = new Array(); // delete íŒŒì¼ ë°°ì—´
			var isSubmitOk = true;

			var img_style = 'width:100px;height:100px;z-index:none'; // ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ ì†ì„±

		//==============================================================================
		//âœ… input ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
			function inputFile(e) {
				var files = e.target.files;
				var filesArr = Array.prototype.slice.call(files);

				if (fileCount + filesArr.length > totalCount) {
					alert('íŒŒì¼ì€ ìµœëŒ€ ' + totalCount + 'ê°œê¹Œì§€ ì—…ë¡œë“œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
					return;
				} else {
					fileCount = fileCount + filesArr.length;
				}

				filesArr.forEach(function(f) {
					var reader = new FileReader();
					reader.onload = function(e) {
									inputFileList.push(f);
									$('#uploadFileList').append(
																`<img style=${img_style} src=${e.target.result}
																	   id=file${fileNum} onclick=fileDelete('file${fileNum}') class=m-1>`
																)
									fileNum++;
								};
					reader.readAsDataURL(f);
				});
				$("#files").val("");
			}

		//==============================================================================
		//âœ… í™”ë©´/ë°°ì—´ì—ì„œ delete ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜			
			function fileDelete(fileNum) {
				var no = fileNum.replace(/[^0-9]/g, "");
				inputFileList[no].is_delete = true;
				$('#' + fileNum).remove();
				fileCount--;
				if(fileCount==0){
					$("#fileErrMsg").text("âœ… ìƒí’ˆ ì‚¬ì§„ì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
					isSubmitOk = false;
				}
			}

		//==============================================================================
		//âœ… í™”ë©´/ë°°ì—´ì—ì„œ delete ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
			function submitForm() {
				// ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ > hidden input valueë¡œ ë„£ê¸°
				var ctgry = $('input[name=ctgry]:checked')
				console.log(ctgry.val())
				
				$("#ctgry").val(ctgry); 
	
				
				//submit ì „ ì²´í¬í•˜ê¸°
				if(submitCheck()){
// 				// â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  ì£¼ì˜3 â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– 
// 				var formData = new FormData($("#aFrm")[0]);
// 				// â– â– â– â†‘ ì£¼ì˜1ì—ì„œ ì§€ì •í•œ í¼ id ì ì–´ì£¼ì„¸ìš” â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– 
				
// 				formData.append("deleteFiles", deleteFileList);

// 				for (var i = 0; i < inputFileList.length; i++) {
// 					if (!inputFileList[i].is_delete) {
// 						formData.append("files", inputFileList[i]);
// 					}
// 				}
// 				// â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  ì£¼ì˜4 â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– 
// 				$.ajax({	url : "/auctInsert",
// 							type : "POST",
// 							data : formData,
// 							processData : false,
// 							contentType : false,
// 							success : function(result) {
// 								console.log(result)
// 									alert("[ì‘ì„± ì™„ë£Œ] ê²Œì‹œê¸€ ì‘ì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ :D");
// 									location.href = "/auctMain";
								
// 							},
// 							error : function(err){
// 								alert("[ì‘ì„± ì‹¤íŒ¨] ê²Œì‹œê¸€ ì‘ì„±ì„ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤. :(");
// 							}
// 						});
// 				// â– â– â– â†‘ â‘ url â‘¡alert ë‚´ìš© â‘¢success > location.href ê²½ë¡œ ë°”ê¿”ì£¼ì„¸ìš” â– â– â– â– â– â– â– â– â– â– â– â– â– â– 
				}
			}
		//==============================================================================
		//âœ… í™”ë©´/ë°°ì—´ì—ì„œ delete ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜
			function submitCheck(){
			console.log(!$("#ctgry").is(':checked'));
			console.log($("#ctgry").is(':checked'));
			//1. íŒŒì¼ ì—…ë¡œë“œ ì—¬ë¶€
			if(inputFileList.length==0){
				$("#fileErrMsg").text("âœ… ìƒí’ˆ ì‚¬ì§„ì„ ë“±ë¡í•´ì£¼ì„¸ìš”.")
				isSubmitOk = false;
			}
			
			//2. ì¹´í…Œê³ ë¦¬ ì„ íƒ ì—¬ë¶€
			else if(!$("#ctgry").is(':checked')){
				console.log("hi")
				$("#ctgryErrMsg").text("âœ… ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.")
				isSubmitOk = false;
			}
			
			//3. ê¸€ì œëª© ì‘ì„± ì—¬ë¶€
			else if($("#auctTtl").val()==""){
				$("#auctTtl").focus();
				isSubmitOk = false;
			}
			
			//4. ê¸€ë‚´ìš© ì‘ì„± ì—¬ë¶€
			else if($("#auctCn").val()==""){
				$("#auctCn").focus();
				isSubmitOk = false;
			}

			//5. ìƒí’ˆê°€ê²© ì‘ì„± ì—¬ë¶€
			else if($("#dlPrc").val()==""){
			   $("#dlPrc").focus();
				isSubmitOk = false;
			}else{
				isSubmitOk = true;
			}		
			
			return isSubmitOk;			
		}
		
		//==============================================================================
		//âœ… (ìˆ˜ì •/ì‚­ì œì—ì„œ ì‚¬ìš©) ê¸°ì¡´ dbì—ì„œ ì‚­ì œí•  íŒŒì¼ë“¤ì„ ë°°ì—´ì— ë‹´ì•„ì„œ ë³´ë‚´ëŠ” í•¨ìˆ˜
			function deleteFile(elem) {
// 				console.log(elem.value);
// 				$(elem).parent().remove();
// 				if (!deleteFileList.includes(elem.value)) {
// 					deleteFileList.push(elem.value);
// 					}
			}
			
			function goList() {
                location.href = "auctList";
            }
	</script>
</body>
</html>