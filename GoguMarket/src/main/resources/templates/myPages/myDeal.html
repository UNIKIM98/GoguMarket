<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://ultraq.net/thymeleaf/layout"
	layout:decorate="~{myPages/sideBar/sideBar}">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<div layout:fragment="myContent">
	
	
	<div class="col-lg-12">
			<form action="#">

				<div class="row">
					<div class="col-lg-12">
						<div class="section-title text-start mb-20">
							<h2 class="uppercase">ì¤‘ê³ ê±°ë˜ë§ˆì´í˜ì´ì§€</h2>
						</div>
					</div>
				</div>
				<hr>
				<!-- single-product-tab -->
								<div class="single-product-tab reviews-tab">
									<ul class="nav mb-20">
										<li><a class="active" href="#description" data-bs-toggle="tab">íŒë§¤ì¤‘</a></li>
										<li><a href="#soldout" data-bs-toggle="tab">íŒë§¤ì™„ë£Œ</a></li>
										<li><a href="#prchs" data-bs-toggle="tab">êµ¬ë§¤ë‚´ì—­</a></li>
									</ul>
									<hr>
									<div class="tab-content">
										<div role="tabpanel" class="tab-pane active show" id="description">
											<p>íŒë§¤ì[useridë¶€ë¥´ê³ ì‹¶ì‚¼]ê°€ í˜„ì¬ íŒë§¤í•˜ê³  ìˆëŠ” ë¬¼í’ˆ ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ ì…ë‹ˆë‹¤</p>
											<!-- â– â– â– â– â– â– ëŒì˜¬í•˜ë ¤ê³  í¼ìœ¼ë¡œ ê°ì‹¸ê¸° -->
											<form id="updateFrm" method="post">
												<div class="featured-product" >
													<div class="active-featured-product slick-arrow-2" >
														<div class="product-item" th:each="deal : ${dealList}"
																					th:if="${deal.STTS} == 'íŒë§¤ì¤‘'">
															<div class="product-img" style="height:150px">
																<a th:href="@{/goguma/dealdetail/{dlNo}(dlNo=${deal.DL_NO})}">
																	<img th:src="${deal.ATCH_NM}" alt="ì¤‘ê³  ëŒ€í‘œ ì‚¬ì§„"/></a>
															</div>
															<div class="product-info">
																<h6 class="product-title"
																	th:text=${deal.DL_TTL}>ìƒí’ˆëª…</h6>
																<h3 class="pro-price" th:text=${deal.DL_PRC}>ê°€ê²©</h3>
																<ul class="action-button">
																<input type="hidden" name="ntslId" id="ntslId" th:value="${session.userId}">
																<input type="hidden" name="dlNo" id="dlNo" th:value="${deal.DL_NO}">
																	<input
																			class="submit-btn-1 mt-30 btn-hover-1" type="submit"
																			id="btnSave" role="button" value="ë“±ë¡í•˜ê¸°">
																</ul>
															</div>
														</div>
													</div>
												</div>
											</form>
										</div>
										<div role="tabpanel" class="tab-pane" id="soldout">
											<p>íŒë§¤ ì™„ë£Œ ë¦¬ìŠ¤íŠ¸ê°€ ë“¤ì–´ê°ˆ ìë¦¬ì…ë‹ˆë‹¤</p>
											<!-- reviews-tab-desc -->
											<div class="featured-product" >
												<div class="active-featured-product slick-arrow-2" >
													<div class="product-item" th:each="deal : ${dealList}"
																				th:if="${deal.STTS} == 'íŒë§¤ì™„ë£Œ'">
														<div class="product-img" style="height:150px">
															<a th:href="@{/goguma/dealdetail/{dlNo}(dlNo=${deal.DL_NO})}">
																<img th:src="${deal.ATCH_NM}" alt="ì¤‘ê³  ëŒ€í‘œ ì‚¬ì§„"/></a>
														</div>
														<div class="product-info">
															<h6 class="product-title"
																th:text=${deal.DL_TTL}>ìƒí’ˆëª…</h6>
															<h3 class="pro-price" th:text=${deal.DL_PRC}>ê°€ê²©</h3>
															<ul class="action-button">
																<button>ëŒì–´ì˜¬ë¦¬ê¸°</button>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>

									 	<div role="tabpanel" class="tab-pane" id="prchs" > 
											<p>êµ¬ë§¤ ë‚´ì—­ ë¦¬ìŠ¤íŠ¸ê°€ ë“¤ì–´ê°ˆ ìë¦¬ì…ë‹ˆë‹¤</p>

											<div class="featured-product" >
												<div class="active-featured-product slick-arrow-2" >
													<div class="product-item" th:each="b : ${buyList}"
																				th:if="${b.PRCHS_ID== session.userId}">
														<div class="product-img" style="height:150px">
															<a th:href="@{/goguma/dealdetail/{dlNo}(dlNo=${b.DL_NO})}">
																<img th:src="${b.ATCH_NM}" alt="ì¤‘ê³  ëŒ€í‘œ ì‚¬ì§„"/></a>
														</div>
														<div class="product-info">
															<h6 class="product-title"
																th:text=${b.DL_TTL}>ìƒí’ˆëª…</h6>
															<h3 class="pro-price" th:text=${b.DL_PRC}>ê°€ê²©</h3>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
			</form>

		</div>
		
		<script th:inline="javascript">
		//==============================================================================
		//âœ… DOM ê·¸ë¦¬ë©´ì„œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ (== document.onload())
		$(function() {
			$("#btnSave").on("click", function() {
				submitForm();
			});
		});
		
		//ğŸ“Œ	 ê³µí†µìœ¼ë¡œ ì“°ì¼ ë³€ìˆ˜ ì„ ì–¸(ì „ì—­ë³€ìˆ˜ var)
		var isSubmitOk = true;
		
		function submitForm() {
				//submit ì „ ì²´í¬í•˜ê¸° : ì²´í¬í• ê±°ì‡ìŒ? ì•„ ì“¸ í¬ì¸íŠ¸ê°€ ìˆëŠ”ì§€ ë¬¼ì–´ë³´ë©´ ì¢‹ì„ë“¯
				if (submitCheck()) {
					var formData = new FormData($("#updateFrm")[0]);
				// â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  ì•„ì‘ìŠ¤ë¶€ë¶„ â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– 
				$.ajax({
					url : "/my/myDealSubmit",
					type : "POST",
					data : formData,
					processData : false,
					contentType : false,
					success : function(result) {
						console.log(result)
						alert("[ì™„ë£Œ]	ê²Œì‹œê¸€ ëŒì–´ì˜¬ë¦¬ê¸°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤ :D");
						location.href = "/goguma/dealdetail/"+result;
					},
					error : function(err) {
						alert("[ì‹¤íŒ¨] ê²Œì‹œê¸€ ëŒì–´ì˜¬ë¦¬ê¸°ë¥¼ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤. :("); 
					}
				});
			}
		}
		function submitCheck() {
			// í¬ì¸íŠ¸ê°€ 200ì´ìƒì´ì–´ì•¼ ëŒì˜¬ì„ í• ìˆ˜ìˆê²Ÿì¬¬? : 200 ë¯¸ë§Œì´ë©´ false
			if ($("#point").val() <"200") {
				$("#point").focus();
				isSubmitOk = false;
			}
			return isSubmitOk;
		}
		
		</script>
	
	</div>
</body>
</html>